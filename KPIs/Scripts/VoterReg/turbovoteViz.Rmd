---
title: ""
output: html_notebook
---
#### Totals
```{r warning=FALSE, echo=FALSE, message=FALSE, fig.width=11, fig.height=6}
ggplot(fileSource, aes(x="", y=n, fill=file)) + 
  geom_bar(stat='identity', width=1) + 
  geom_text(aes(x="",y=pos, label = n), size=5) + 
  coord_polar("y", start=0) +
  theme_minimal() +
  scale_fill_brewer(palette = 'Set2') +
  labs(y='',x='',title=paste0('Total = ',sum(fileSource$n))) +
  scale_y_continuous(breaks=pretty_breaks(5)) +
  theme(
    plot.title = element_text(hjust=.5, size=20),
    legend.title = element_blank(),
    legend.position = "bottom"
    ) 
```

#### Month over Month Pacing
* We're pacing better than March!
```{r warning=FALSE, echo=FALSE, message=FALSE, fig.width=11, fig.height=6}
ggplot(MoM, aes(x=dayOfMonth, value)) +
  geom_line(aes(color=month)) + 
  labs(title='Voters Registered Month over Month', x='Day of Month', y='Voters Registered') +
  theme(plot.title = element_text(hjust=.5))
```

* Web is showing strongest performance to date. Other channels are lagging
```{r warning=FALSE, echo=FALSE, message=FALSE, fig.width=11, fig.height=6}
ggplot(MoM.Source, aes(x=dayOfMonth, value)) +
  geom_line(aes(color=month)) + 
  facet_wrap(~Source) +
  labs(title='Voters Registered Month over Month by Source', x='Day of Month', y='Voters Registered') +
  theme(plot.title = element_text(hjust=.5))
```

#### Referral Source
* Unsurprisingly, web also makes up the bulk of referral sources
```{r warning=FALSE, echo=FALSE, message=FALSE, fig.width=11, fig.height=6}
ggplot(Source, aes(x=status, y=value, fill=reorder(source, value))) +
  geom_bar(stat='identity', position='stack') +
  geom_text(
    position=position_stack(vjust = 0.5), size=3, 
    aes(label=ifelse(value/sum(value)>.01 | (value<1 & value>.02),label,NA))
    ) +
  stat_summary(fun.y = sumIf, aes(label = ..y.., group = status), geom = "text", vjust=-.2) +
  facet_wrap(~variable, scales='free') +
  labs(y='') +
  scale_y_continuous(breaks=pretty_breaks(10)) +
  scale_fill_brewer(palette = 'Set2') + 
  labs(
    x=leg,
    y='',
    title='Counts and Proportions of Form Status split by Source'
    ) +
  theme(plot.title = element_text(hjust=.5)) + 
  guides(fill=guide_legend(title='Source'))
```
#### Source Details

* We've gotten access to many denominators. Planning to build into report this week

**Email**

  - Now with more informative buckets!
  - We've gotten access to newsletter info in quasar and so can start getting conversion rates
  
**SMS**

  - Starting to get some traction from SMS Tests
  
**Social**

  - Generally isn't performing very well, but Facebook is doing better than the others. Is this because we've done more on facebook or because our efforts are smarter?
  
**Web**

  - Campaign pages and Hellobar are dominating 
  - We have full phoenix funnels, and so can start report conversions here too
  
**Partners**

  - Starting to get traction, primarily from quizlet

```{r warning=FALSE, echo=FALSE, message=FALSE, fig.width=10, fig.height=30}
library(gridExtra)
ss <- split(sourceStep, f=sourceStep$source)
p1 <- ggplot(ss$email, aes(x=status, y=value, fill=reorder(details, value))) +
  geom_bar(stat='identity', position='stack') +
  geom_text(
    position=position_stack(vjust = 0.5), size=3,
    aes(label=ifelse(value/sum(value)>.005 | (value<1 & value>.02),label,NA))
    ) +
  stat_summary(fun.y = sumIf, aes(label = ..y.., group = status), geom = "text", vjust=-.2) +
  scale_y_continuous(breaks=pretty_breaks(10)) +
  facet_wrap(~variable, scales='free')  + 
  labs(x='',y='') +
  theme(plot.title = element_text(hjust=.5)) + 
  guides(fill=guide_legend(title='Source Details'))
p2 <- p1 %+% ss$sms %+% ggtitle('SMS')
p3 <- p1 %+% ss$social %+% ggtitle('Social')
p4 <- p1 %+% ss$web %+% ggtitle('Web')
p1 <- p1 %+% ss$email %+% ggtitle('Email')
p5 <- p1 %+% ss$partner %+% ggtitle('Partner')
grid.arrange(
  p1,p2,p3,p4,p5,ncol=1,
  top='Counts and Proportions of Form Status split by Source and Details',
  bottom=leg
  )

```

#### Northstar Source
* Web users disproportionately represent all those going through the flow 
* Similar proportions of statuses across user channels
```{r warning=FALSE, echo=FALSE, message=FALSE, fig.width=11, fig.height=6}
library(scales)
sumIf <- function(x) {
  val <- ifelse(sum(x)>1, sum(x), NA)
}
leg <- 'Confirmed: Self-Reported (RB); Unknown: Dropped Off; Register: Voter Registration'
ggplot(uSource, aes(x=status, y=value, fill=reorder(user_source, value))) +
  geom_bar(stat='identity', position='stack') +
  geom_text(position=position_stack(vjust = 0.5), aes(label=label), size=3) +
  stat_summary(fun.y = sumIf, aes(label = ..y.., group = status), geom = "text", vjust=-.2) +
  facet_wrap(~variable, scales='free') +
  scale_fill_brewer(palette = 'Set2') +
  scale_y_continuous(breaks=pretty_breaks(10)) + 
  labs(
    x=leg,
    y='',
    title='Counts and Proportions of Form Status split by User Source'
    ) +
  theme(plot.title = element_text(hjust=.5)) + 
  guides(fill=guide_legend(title='User Source'))
```

#### Signups & Reportbacks
* The fact that online completers also have more reportbacks is very interesting. Could this mean that this is a cohort of people who is just generally more comfortable doing activities on the web and so are both more likely to submit photo reportbacks and submit forms online? Does this mean more people could be doing the process online than currently are? If so, how can we make it easier for people to know what they are can and can't do?
```{r warning=FALSE, echo=FALSE, message=FALSE, fig.width=11, fig.height=6}
ggplot(camp, aes(x=variable, y=value, fill=reorder(ds_vr_status, -value))) +
  geom_bar(stat='identity', position='dodge') +
  facet_wrap(~variable, scales='free') +
  geom_text(position=position_dodge(width=.9), aes(label=round(value, 2.5)), size=3, vjust=-.2) +
  scale_y_continuous(breaks=pretty_breaks(10)) +
  scale_fill_brewer(palette = 'Set2') + 
  labs(
    x=leg,
    y='',
    title='Average Number of Reportbacks and Signups by Form Status'
    ) +
  theme(plot.title = element_text(hjust=.5)) + 
  guides(fill=guide_legend(title='Status'))
```

